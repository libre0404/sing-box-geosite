sing-box è§„åˆ™é›†è‡ªåŠ¨è½¬æ¢å·¥å…·
æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ªç”¨äºå°†å¸¸è§è¿‡æ»¤è§„åˆ™ï¼ˆå¦‚ Surge, Clash, TXT æ ¼å¼ï¼‰è‡ªåŠ¨è½¬æ¢å¹¶ç¼–è¯‘ä¸º sing-box ä¸“ç”¨äºŒè¿›åˆ¶è§„åˆ™é›†ï¼ˆ.srsï¼‰çš„è‡ªåŠ¨åŒ–å·¥å…·ã€‚

ğŸŒŸ åŠŸèƒ½ç‰¹æ€§
æ™ºèƒ½è§£æï¼šæ”¯æŒ DOMAINã€DOMAIN-SUFFIXã€IP-CIDR ç­‰å¤šç§æ ¼å¼ï¼Œå¹¶èƒ½è‡ªåŠ¨å¤„ç† YAML Payload æ ¼å¼ã€‚

æœ¬åœ°ä¸äº‘ç«¯åŒæ”¯æŒï¼šæ—¢å¯ä»¥åœ¨ Debian æœåŠ¡å™¨ä¸Šé€šè¿‡ Shell è„šæœ¬è¿è¡Œï¼Œä¹Ÿå¯ä»¥é€šè¿‡ GitHub Actions è‡ªåŠ¨åŒæ­¥ã€‚

è‡ªåŠ¨ç¼–è¯‘ï¼šé›†æˆ sing-box ç¼–è¯‘å™¨ï¼Œç›´æ¥è¾“å‡ºé«˜æ€§èƒ½çš„äºŒè¿›åˆ¶ .srs æ–‡ä»¶ã€‚

ä¾èµ–è‡ªåŠ¨ç®¡ç†ï¼šDebian è„šæœ¬ä¼šè‡ªåŠ¨åˆ›å»º Python è™šæ‹Ÿç¯å¢ƒå¹¶å®‰è£…æ‰€éœ€ä¾èµ–ã€‚

ğŸ›  Debian æœ¬åœ°ä½¿ç”¨è¯´æ˜
æ­¤æ–¹å¼é€‚ç”¨äºåœ¨è‡ªå·±çš„ Linux æœåŠ¡å™¨ä¸Šç»´æŠ¤è§„åˆ™ï¼Œä¾›æœ¬åœ° sing-box å®¢æˆ·ç«¯ç›´æ¥è°ƒç”¨ã€‚

1. å¿«é€Ÿå¼€å§‹
ç¡®ä¿è„šæœ¬å…·æœ‰æ‰§è¡Œæƒé™å¹¶è¿è¡Œï¼š

Bash

chmod +x update_rules.sh
sudo ./update_rules.sh
è„šæœ¬ä¼šè‡ªåŠ¨å®‰è£… python3-venv åŠç›¸å…³ç»„ä»¶ã€‚

è½¬æ¢é€»è¾‘ç”± main.py æ‰§è¡Œï¼Œä½¿ç”¨è™šæ‹Ÿç¯å¢ƒä¸­çš„ Pythonã€‚

è§„åˆ™æ–‡ä»¶é»˜è®¤è¾“å‡ºåˆ° /etc/sing-box/rules ç›®å½•ã€‚

2. å®šæ—¶è‡ªåŠ¨ä»»åŠ¡ (Crontab)
å¦‚æœéœ€è¦æ¯å¤©å‡Œæ™¨ 4 ç‚¹è‡ªåŠ¨æ›´æ–°è§„åˆ™ï¼Œè¯·æ‰§è¡Œ sudo crontab -e å¹¶æ·»åŠ ï¼š

Bash

0 4 * * * /path/to/your/update_rules.sh > /dev/null 2>&1
â˜ï¸ GitHub Actions äº‘ç«¯åŒæ­¥
æ‚¨å¯ä»¥åˆ©ç”¨ GitHub Actions å®ç°è§„åˆ™çš„äº‘ç«¯è‡ªåŠ¨è½¬æ¢å’Œæ‰˜ç®¡ã€‚

1. æƒé™è®¾ç½®
å‰å¾€ä»“åº“ Settings -> Actions -> General -> Workflow permissionsï¼Œå‹¾é€‰ Read and write permissionsï¼Œå¦åˆ™ Actions æ— æ³•å°†ç”Ÿæˆçš„è§„åˆ™æ¨é€å›ä»“åº“ã€‚

2. è‡ªåŠ¨åŒ–æµç¨‹
è§¦å‘æœºåˆ¶ï¼šæ”¯æŒä»£ç æ¨é€ï¼ˆpushï¼‰è§¦å‘ã€æ‰‹åŠ¨è§¦å‘ï¼ˆworkflow_dispatchï¼‰ä»¥åŠå®šæ—¶ä»»åŠ¡ï¼ˆcronï¼‰ã€‚

ç¯å¢ƒæ„å»ºï¼šè‡ªåŠ¨ä¸‹è½½å¹¶å®‰è£…æŒ‡å®šç‰ˆæœ¬çš„ sing-box ç¼–è¯‘å™¨ã€‚

æ–‡ä»¶äº§å‡ºï¼šè½¬æ¢åçš„ .json å’Œ .srs æ–‡ä»¶ä¼šè‡ªåŠ¨æäº¤å¹¶ä¿å­˜åœ¨ä»“åº“ç›®å½•ä¸­ã€‚

ğŸ“ é…ç½®æŒ‡å—
è§„åˆ™æº (links.txt)
åœ¨ links.txt ä¸­æ·»åŠ è§„åˆ™é“¾æ¥ï¼Œæ”¯æŒä»¥ä¸‹æ ¼å¼ï¼š

è¿œç¨‹ URLï¼šä¾‹å¦‚ https://raw.githubusercontent.com/.../gfw.txtã€‚

æœ¬åœ°è·¯å¾„ï¼šæ”¯æŒé€šé…ç¬¦åŒ¹é…ï¼Œä¾‹å¦‚ /mnt/data/rules/*.txt (ä»…åœ¨æœ¬åœ°è¿è¡Œæ—¶æœ‰æ•ˆ)ã€‚

sing-box å¼•ç”¨ç¤ºä¾‹
ç”Ÿæˆçš„äºŒè¿›åˆ¶è§„åˆ™å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼åœ¨ sing-box çš„ config.json ä¸­å¼•ç”¨ï¼š

JSON

{
  "tag": "my-rule",
  "type": "remote",
  "format": "binary",
  "url": "https://raw.githubusercontent.com/æ‚¨çš„ç”¨æˆ·å/ä»“åº“å/main/rule/æ–‡ä»¶å.srs",
  "download_detour": "proxy"
}
ğŸ¤ è‡´è°¢
æœ¬é¡¹ç›®é€»è¾‘å‚è€ƒåŠè‡´è°¢ï¼ˆæ’åä¸åˆ†å…ˆåï¼‰ï¼š @izumiChan16 | @ifaintad | @NobyDa | @blackmatrix7 | @DivineEngine
